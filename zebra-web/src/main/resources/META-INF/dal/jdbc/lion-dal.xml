<?xml version="1.0" encoding="UTF-8"?>
<entities do-package="com.dianping.zebra.web.dal.lion" gen="true">
  <entity name="config" table="config" alias="c">
    <var name="ds" value-type="String"/>
    <readsets>
      <readset name="REFERENCE" all="true">
        <member name="id"/>
      	<member name="key"/>
      </readset>
    </readsets>
    <query-defs>
      <query name="find-by-Project-Id" type="SELECT" multiple="true">
      	 <param name="project-id" />
         <statement><![CDATA[SELECT <FIELDS/>
         FROM <TABLE/>
         WHERE <FIELD name='project-id'/> = ${project-id}]]></statement>
      </query>
      <query name="find-by-project-and-ds" type="SELECT" multiple="true">
      	<param name="project-id" />
      	<param name="ds"/>
      	<statement><![CDATA[SELECT <FIELDS/>
        FROM <TABLE/>
        WHERE <FIELD name='project-id'/> = ${project-id}
        AND <FIELD name='key'/> like ${ds}]]></statement>
      </query>
    </query-defs>
  </entity>
   <entity name="config-instance" table="config_instance" alias="ci">
    <var name="config-ids" value-type="int[]"/>
    <var name="ds" value-type="String"/>
    <updatesets>
      <updateset name="REFERENCE">
      	<member name="value"/>
      </updateset>
    </updatesets>
    <query-defs>
      <query name="find-by-ConfigId-And-EnvId" type="SELECT" multiple="true">
        <param name="config-ids" />
        <param name="env-id" />
        <statement><![CDATA[SELECT <FIELDS/>
        FROM <TABLE/>
        WHERE <FIELD name='config-id'/> in <IN>${config-ids}</IN>
        AND <FIELD name='env-id'/> = ${env-id}]]></statement>
      </query>
      <query name="find-by-ds" type="SELECT" multiple="true">
      	<param name="ds"/>
      	<param name="env-id" />
      	<statement><![CDATA[SELECT <FIELDS/>
        FROM <TABLE/>
        WHERE <FIELD name='value'/> like ${ds}
        AND <FIELD name='env-id'/> = ${env-id}]]></statement>
      </query>
      <query name="insert" type="INSERT">
        <statement><![CDATA[INSERT IGNORE INTO <TABLE/>(<FIELDS/>)
        VALUES(<VALUES/>)]]></statement>
      </query>
      <query name="update-by-PKs" type="UPDATE">
      	<statement><![CDATA[UPDATE <TABLE/>
        SET <FIELDS/>
        WHERE <FIELD name='id'/> in <IN>${config-ids}</IN>]]></statement>
      </query>
      <query name="delete-by-ConfigIds-And-EnvId" type="DELETE">
      	<param name="config-ids" />
        <param name="env-id" />
        <statement><![CDATA[DELETE FROM <TABLE/>
        WHERE <FIELD name='config-id'/> in <IN>${config-ids}</IN>
        AND <FIELD name='env-id'/> = ${env-id}]]></statement>
      </query>
    </query-defs>
  </entity>
</entities>
