<div class="modal-header">
    <h4 class="modal-title">
        <form class="form-inline" role="form">
            <span>{{name}}</span>
        </form>
    </h4>
</div>
<div class="modal-body">
    <ul class="nav nav-tabs">
        <li role="presentation" ng-class="{'active' : shard.active}" ng-repeat="shard in configs.tableShardConfigs">
            <a href ng-click="changeActive(shard.tableName)">{{shard.tableName}}</a>
        </li>
        <li role="presentation">
            <a href ng-click="addTable()">
                <span title="Add Table" class="glyphicon glyphicon-plus" aria-hidden="true"></span>
            </a>
        </li>
    </ul>
    <br/>
    <div ng-show="shard.active" class="form-inline" ng-repeat="shard in configs.tableShardConfigs">
        <a href ng-click="removeTable(configs,$index)" style="float:right">
            <span style="color:#d9534f" title="Remove Table" class="glyphicon glyphicon-remove" aria-hidden="true"></span>
        </a>
        <div class="form-group clearfix">
            <label popover-trigger="mouseenter" popover="逻辑表名">Table Name</label>&nbsp;
            <input type="text" ng-change="tableNameChange(shard);" ng-model="shard.tableName" />&nbsp;&nbsp;
            <label popover-trigger="mouseenter" popover="">GeneratedPK</label>&nbsp;
            <input type="text" ng-model="shard.generatedPK" />
        </div>
        <br/>
        <br/>
        <div class="form-group">
            <label popover-trigger="mouseenter" popover="维度配置">Dimension Configs</label>
            <a href ng-click="addDimension(shard)">
                <span title="Add Dimension" class="glyphicon glyphicon-plus" aria-hidden="true"></span>
            </a>
        </div>
        <div class="well well-sm" ng-repeat="dimension in shard.dimensionConfigs">
            <a href ng-click="removeDimension(shard,$index)" style="float:right">
                <span style="color:#d9534f" title="Remove Dimension" class="glyphicon glyphicon-remove" aria-hidden="true"></span>
            </a>
            <div class="form-group clearfix">
                <label popover-trigger="mouseenter" popover="是否为主维度">主维度</label>&nbsp;
                <input type="checkbox" ng-model="dimension.isMaster" />
                <label popover-trigger="mouseenter" popover="是否需要同步">需要同步</label>&nbsp;
                <input type="checkbox" ng-model="dimension.needSync" />
                <br/>
                <label popover-trigger="mouseenter" popover="分库分组">Db Rule</label>&nbsp;
                <input style="width:300px;" type="text" ng-model="dimension.dbRule" />&nbsp;&nbsp;
                <label popover-trigger="mouseenter" popover="库索引">Db Indexes</label>&nbsp;
                <input style="width:250px;" type="text" ng-model="dimension.dbIndexes" />
                <br/>
                <label popover-trigger="mouseenter" popover="分表规则">Tb Rule</label>&nbsp;
                <input style="width:300px;" type="text" ng-model="dimension.tbRule" />&nbsp;&nbsp;
                <label popover-trigger="mouseenter" popover="表前缀示例: alldb:[_0,_9] 或者 everydb:[0,4]">Tb Suffix</label>&nbsp;
                <input type="text" ng-model="dimension.tbSuffix" />
                <br/>
                <label popover-trigger="mouseenter" popover="热点数据">Exceptions</label>
                <a href ng-click="addException(dimension)">
                    <span title="Add Exceptions" class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                </a>
                <div class="well well-sm" ng-repeat="exception in dimension.exceptions">
                    <a href ng-click="removeException(dimension,$index)" style="float:right">
                        <span style="color:#d9534f" title="Remove Exception" class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                    </a>
                    <label popover-trigger="mouseenter" popover="目标数据库" class="clearfix">Db</label>&nbsp;
                    <input type="text" ng-model="exception.db" />&nbsp;&nbsp;
                    <label popover-trigger="mouseenter" popover="目标表">Table</label>&nbsp;
                    <input type="text" ng-model="exception.table" />
                    <br/>
                    <label popover-trigger="mouseenter" popover="条件">Condition</label>&nbsp;
                    <input type="text" ng-model="exception.condition" />
                    <br/>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal-footer">
    <form class="form-inline" role="form">
        <button type="button" class="btn btn-success btn-sm" ng-click="save()">Save</button>
        <button title="直接使用当前配置测试，不保存到Lion" type="button" class="btn btn-primary btn-sm" ng-click="test()">Test</button>
        <button type="button" class="btn btn-warning btn-sm" ng-click="close()">Cancel</button>
    </form>
</div>
